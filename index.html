<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WTR UNL Sealed Generator</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background: #f9f9f9;
    }
    button {
      padding: 1rem;
      margin-bottom: 1rem;
      font-size: 1rem;
    }
    pre {
      background: #fff;
      padding: 1rem;
      border: 1px solid #ccc;
      overflow-x: auto;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>WTR UNL Sealed Generator</h1>
  <button onclick="generateDeck(true)">Generate Sealed Pool with Drone</button>
  <button onclick="generateDeck(false)">Generate Sealed Pool with out Drone</button>
  <button onclick="copyToClipboard()">Copy to Clipboard</button>
  <pre id="output"></pre>

  <script>
    function sample(array, count) {
      const copy = [...array];
      const result = [];
      for (let i = 0; i < count && copy.length > 0; i++) {
        const index = Math.floor(Math.random() * copy.length);
        result.push(copy.splice(index, 1)[0]);
      }
      return result;
    }

    const LEGENDARY = ["Scabskin Leathers", "Tectonic Plating", "Mask of Momentum", "Braveforge Bracers", "Fyendal's Spring Tunic"]
    const MAJESTIC = ["Alpha Rampage (red)", "Bloodrush Bellow (yellow)", "Crippling Crush (red)", "Spinal Crush (red)", "Lord of Wind (blue)", "Ancestral Empowerment (red)", "Glint the Quicksilver (blue)", "Steelblade Supremacy (red)", "Enlightened Strike (red)", "Tome of Fyendal (yellow)"]
    const SUPER = ["Reckless Swing (blue)", "Sand Sketched Plan (blue)", "Bone Head Barrier (yellow)", "Cranial Crush (blue)", "Forged for War (yellow)", "Show Time! (blue)", "Mugenshi: RELEASE (blue)", "Hurricane Technique (yellow)", "Pounding Gale (red)", "Rout (red)", "Singing Steelblade (yellow)", "Ironsong Determination (yellow)", "Last Ditch Effort (blue)", "Crazy Brew (blue)", "Rememberance (yellow)"]

    const BRUTE_RARE = ["Breakneck Battery (red)", "Breakneck Battery (yellow)", "Breakneck Battery (blue)", "Savage Feast (red)", "Savage Feast (yellow)", "Savage Feast (blue)", "Barraging Beatdown (red)", "Barraging Beatdown (yellow)", "Barraging Beatdown (blue)"]
    const GUARDIAN_RARE = ["Disable (red)", "Disable (yellow)", "Disable (blue)", "Staunch Response (red)", "Staunch Response (yellow)", "Staunch Response (blue)", "Blessing of Deliverance (red)", "Blessing of Deliverance (yellow)", "Blessing of Deliverance (blue)"]
    const NINJA_RARE = ["Fluster Fist (red)", "Fluster Fist (yellow)", "Fluster Fist (blue)", "Blackout Kick (red)", "Blackout Kick (yellow)", "Blackout Kick	(blue)", "Flic Flak (red)", "Flic Flak (yellow)", "Flic Flak (blue)"]
    const WARRIOR_RARE = ["Overpower (red)", "Overpower (yellow)", "Overpower (blue)", "Steelblade Shunt (red)", "Steelblade Shunt (yellow)", "Steelblade Shunt (blue)", "Warrior's Valor (red)", "Warrior's Valor (yellow)", "Warrior's Valor (blue)"]
    const GENERIC_RARE_D = ["Snatch (red)", "Snatch (yellow)", "Snatch (blue)", "Energy Potion (blue)", "Potion of Strength (blue)", "Timesnap Potion (blue)", "Sigil of Solace (red)", "Sigil of Solace (yellow)", "Sigil of Solace (blue)", "Drone of Brutality (red)", "Drone of Brutality (yellow)", "Drone of Brutality (blue)"]
    const GENERIC_RARE = ["Snatch (red)", "Snatch (yellow)", "Snatch (blue)", "Energy Potion (blue)", "Potion of Strength (blue)", "Timesnap Potion (blue)", "Sigil of Solace (red)", "Sigil of Solace (yellow)", "Sigil of Solace (blue)"]

    const ALL_RARES_D = [...BRUTE_RARE, ...GUARDIAN_RARE, ...NINJA_RARE, ...WARRIOR_RARE, ...GENERIC_RARE_D];
    const ALL_RARES = [...BRUTE_RARE, ...GUARDIAN_RARE, ...NINJA_RARE, ...WARRIOR_RARE, ...GENERIC_RARE];

    const BRUTE_COMMON = ["Savage Swing (red)", "Savage Swing (yellow)", "Savage Swing (blue)", "Pack Hunt (red)", "Pack Hunt (yellow)", "Pack Hunt (blue)", "Smash Instinct (red)", "Smash Instinct (yellow)", "Smash Instinct (blue)", "Wrecker Romp (red)", "Wrecker Romp (yellow)", "Wrecker Romp (blue)", "Awakening Bellow (red)", "Awakening Bellow (yellow)", "Awakening Bellow (blue)", "Primeval Bellow (red)", "Primeval Bellow (yellow)", "Primeval Bellow (blue)"]
    const GUARDIAN_COMMON = ["Buckling Blow (red)", "Buckling Blow (yellow)", "Buckling Blow (blue)", "Cartilage Crush (red)", "Cartilage Crush (yellow)", "Cartilage Crush (blue)", "Crush Confidence (red)", "Crush Confidence (yellow)", "Crush Confidence (blue)", "Debilitate (red)", "Debilitate (yellow)", "Debilitate (blue)", "Emerging Power (red)", "Emerging Power (yellow)", "Emerging Power (blue)", "Stonewall Confidence (red)", "Stonewall Confidence (yellow)", "Stonewall Confidence (blue)"]
    const NINJA_COMMON = ["Open the Center (red)", "Open the Center (yellow)", "Open the Center (blue)","Head Jab (red)", "Head Jab (yellow)", "Head Jab (blue)", "Rising Knee Thrust (red)", "Rising Knee Thrust (yellow)", "Rising Knee Thrust (blue)", "Surging Strike (red)", "Surging Strike (yellow)", "Surging Strike (blue)", "Whelming Gustwave (red)", "Whelming Gustwave (yellow)", "Whelming Gustwave (blue)"]
    const WARRIOR_COMMON = ["Ironsong Response (red)", "Ironsong Response (yellow)", "Ironsong Response (blue)", "Biting Blade (red)", "Biting Blade (yellow)", "Biting Blade (blue)", "Stroke of Foresight (red)", "Stroke of Foresight (yellow)", "Stroke of Foresight (blue)", "Sharpen Steel (red)", "Sharpen Steel (yellow)", "Sharpen Steel (blue)", "Driving Blade (red)", "Driving Blade (yellow)", "Driving Blade (blue)", "Nature's Path Pilgrimage (red)", "Nature's Path Pilgrimage (yellow)", "Nature's Path Pilgrimage (blue)"]

    const CLASS_COMMON = [...BRUTE_COMMON, ...GUARDIAN_COMMON, ...NINJA_COMMON, ...WARRIOR_COMMON]
    
    const CLASS_POOLS = [
        BRUTE_COMMON,
        GUARDIAN_COMMON,
        NINJA_COMMON,
        WARRIOR_COMMON,
    ];
    
    const POOL_NAMES = [
        "Brute",
        "Guardian",
        "Ninja",
        "Warrior",
        "Generic",
    ];
    
    const GENERIC_COMMON = ["Barraging Brawnhide (red)", "Barraging Brawnhide (yellow)", "Barraging Brawnhide (blue)", "Demolition Crew (red)", "Demolition Crew (yellow)", "Demolition Crew (blue)", "Flock of the Feather Walkers (red)", "Flock of the Feather Walkers (yellow)", "Flock of the Feather Walkers (blue)", "Nimble Strike (red)", "Nimble Strike (yellow)", "Nimble Strike (blue)", "Raging Onslaught (red)", "Raging Onslaught (yellow)", "Raging Onslaught (blue)", "Scar for a Scar (red)", "Scar for a Scar (yellow)", "Scar for a Scar (blue)", "Scour the Battlescape (red)", "Scour the Battlescape (yellow)", "Scour the Battlescape (blue)", "Regurgitating Slog (red)", "Regurgitating Slog (yellow)", "Regurgitating Slog (blue)", "Wounded Bull (red)", "Wounded Bull (yellow)", "Wounded Bull (blue)", "Wounding Blow (red)", "Wounding Blow (yellow)", "Wounding Blow (blue)", "Pummel (red)", "Pummel (yellow)", "Pummel (blue)", "Razor Reflex (red)", "Razor Reflex (yellow)", "Razor Reflex (blue)", "Unmovable (red)", "Unmovable (yellow)", "Unmovable (blue)", "Sink Below (red)", "Sink Below (yellow)", "Sink Below (blue)", "Nimblism (red)", "Nimblism (yellow)", "Nimblism (blue)", "Sloggism (red)", "Sloggism (yellow)", "Sloggism (blue)"]
    
    const CLASS_EQUIPMENT = ["Barkbone Strapping", "Helm of Isen's Peak", "Breaking Scales", "Refraction Bolters"];
    const GENERIC_EQUIPMENT = ["Hope Merchant's Hood", "Heartened Cross Strap", "Goliath Gauntlet", "Snapdragon Scalers", "Ironrot Helm", "Ironrot Plate", "Ironrot Gauntlet", "Ironrot Legs"];
    const COMMON_EQUIPMENT = [...CLASS_EQUIPMENT, ...GENERIC_EQUIPMENT];

    
    function generateDeck(drone) {
      let deck = [];
      let equipment = [];

      for (let i = 0; i < 6; i++) {
        // Pick one index to get 1 card
        const oneOfIndex = Math.floor(Math.random() * CLASS_POOLS.length);

        CLASS_POOLS.forEach((pool, j) => {
          deck.push(...sample(pool, j === oneOfIndex ? 1 : 2));
        });
        
        deck.push(...sample(GENERIC_COMMON, 4));
        equipment.push(...sample(COMMON_EQUIPMENT, 1));

        const rareRoll = Math.random();
        if (drone) {
          if (rareRoll < 1 / 12) {
            deck.push(...sample(MAJESTIC, 1), ...sample(ALL_RARES_D, 1));
          } else if (rareRoll < 1 / 12 + 1 / 6) {
            deck.push(...sample(SUPER, 1), ...sample(ALL_RARES_D, 1));
          } else {
            deck.push(...sample(ALL_RARES_D, 2));
          }
        } else {
          if (rareRoll < 1 / 12) {
            deck.push(...sample(MAJESTIC, 1), ...sample(ALL_RARES, 1));
          } else if (rareRoll < 1 / 12 + 1 / 6) {
            deck.push(...sample(SUPER, 1), ...sample(ALL_RARES, 1));
          } else {
            deck.push(...sample(ALL_RARES, 2));
          }
        }

        const foilRoll = Math.random();
        if (foilRoll < 1 / 96) {
          equipment.push(...sample(LEGENDARY, 1));
        } else if (foilRoll < 1 / 96 + (1 - 1 / 96) * (1 / 168)) {
          deck.push(...sample(MAJESTIC, 1));
        } else if (foilRoll < 1 / 96 + (1 - 1 / 96) * (3 / 168)) {
          deck.push(...sample(SUPER, 1));
        } else if (foilRoll < 1 / 96 + (1 - 1 / 96) * (24 / 168)) {
          deck.push(...sample(ALL_RARES, 1));
        } else {
          deck.push(...sample([...GENERIC_COMMON, ...CLASS_COMMON, ...COMMON_EQUIPMENT], 1));
        }
      }
      
      var classCount = {};
      deck.forEach((card, index) => {
        //Check which class the card belongs to
        if (BRUTE_COMMON.includes(card) || BRUTE_RARE.includes(card)) {
          classCount["Brute"] = (classCount["Brute"] || 0) + 1;
        } else if (GUARDIAN_COMMON.includes(card) || GUARDIAN_RARE.includes(card)) {
          classCount["Guardian"] = (classCount["Guardian"] || 0) + 1;
        } else if (NINJA_COMMON.includes(card) || NINJA_RARE.includes(card)) {
          classCount["Ninja"] = (classCount["Ninja"] || 0) + 1;
        } else if (WARRIOR_COMMON.includes(card) || WARRIOR_RARE.includes(card)) {
          classCount["Warrior"] = (classCount["Warrior"] || 0) + 1;
        } else {
          classCount["Generic/Maj/Equip/Super/Legendary"] = (classCount["Generic/Maj/Equip/Super/Legendary"] || 0) + 1;
        }
      });
      console.log("Class counts:", classCount);

      const countCards = list =>
        list.reduce((acc, card) => {
          acc[card] = (acc[card] || 0) + 1;
          return acc;
        }, {});

     const output = [];
      const now = new Date();
      const formattedDate = now.toLocaleDateString("en-US", { year: 'numeric', month: 'long', day: 'numeric' });
      const timestamp = now.toISOString().slice(0, 19).replace(/[:T]/g, "_");

      output.push("Player Name / ID\tWTR_UNL_SEALED");
      output.push(`Date\t${formattedDate}`);
      output.push("Event\tWTR Sealed Training");
      output.push("Format\tSealed Deck");
      output.push("Hero / Class\tBravo (Guardian)");
      output.push("Result\t1st\n");
      output.push("\nArena cards\n2x Harmonized Kodachi\n1x Dawnblade\n1x Romping Club\n1x Anothos\n");

      output.push("Equipment:");
      for (const [card, qty] of Object.entries(countCards(equipment))) {
        output.push(`${qty}x ${card}`);
      }

      output.push("\nDeck cards:");
      for (const [card, qty] of Object.entries(countCards(deck))) {
        output.push(`${qty}x ${card}`);
      }

      document.getElementById("output").textContent = output.join("\n");
    }

    function copyToClipboard() {
      const output = document.getElementById("output").textContent;
      navigator.clipboard.writeText(output).then(() => {
        alert("Deck copied to clipboard!");
      }).catch(err => {
        alert("Failed to copy: " + err);
      });
    }
  </script>
</body>
</html>
